"use strict";var v=Object.create;var l=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var I=(e,t)=>{for(var o in t)l(e,o,{get:t[o],enumerable:!0})},d=(e,t,o,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of k(t))!S.call(e,a)&&a!==o&&l(e,a,{get:()=>t[a],enumerable:!(i=x(t,a))||i.enumerable});return e};var R=(e,t,o)=>(o=e!=null?v(P(e)):{},d(t||!e||!e.__esModule?l(o,"default",{value:e,enumerable:!0}):o,e)),T=e=>d(l({},"__esModule",{value:!0}),e);var D={};I(D,{default:()=>F});module.exports=T(D);var r=require("@raycast/api");var u=require("@raycast/api"),f=require("child_process"),s=require("fs/promises"),g=require("path"),w=require("os"),p;function $(){if(p)return p;let e=(0,w.tmpdir)(),t=Date.now()+"-"+Math.round(Math.random()*1e9);return p=(0,g.join)(e,`remove-bg-${t}.png`),p}async function h(e){try{let t=decodeURI(e.replace("file://","")),o=await(0,s.readFile)(t),i=$();return await(0,s.writeFile)(i,o),i}catch(t){throw console.error("Error copying image file:",t),t}}async function y({paths:e}){let t=(0,g.join)(u.environment.assetsPath,"remove-background");return await(0,s.chmod)(t,"755"),await new Promise((i,a)=>{(0,f.exec)(`${t} ${e.map(n=>JSON.stringify(n)).join(" ")}`,(n,c,b)=>{n&&a(c+" "+b),i(c)})})}var m=R(require("path"));async function F(){try{let e=[],t,{file:o}=await r.Clipboard.read();if(o)t=await h(o),e=[t];else{let a=await(0,r.getSelectedFinderItems)();a.length>0&&(e=a.map(n=>n.path))}if(e.length===0){await(0,r.showToast)({style:r.Toast.Style.Failure,title:"No image selected",message:"Please select an image in Finder or copy one to clipboard"});return}await y({paths:e});let i=e.map(a=>{let n=m.default.extname(a),c=m.default.basename(a,n);return m.default.resolve(m.default.dirname(a),`${c}-background-removed${n}`)});t&&await r.Clipboard.copy({file:i[0]}),await(0,r.showToast)({style:r.Toast.Style.Animated,title:"Removing background"}),await(0,r.showHUD)("Removed background from image"),t||await(0,r.showInFinder)(i[0]),await(0,r.closeMainWindow)()}catch(e){console.error(e),await(0,r.showToast)({style:r.Toast.Style.Failure,title:"Error removing background",message:String(e).trim()})}}
